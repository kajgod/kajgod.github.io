<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Next.js app on GitHub Pages</title><link rel="icon" href="/favicon.ico"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="true"/><link rel="canonical" href="https://kajgod.github.io/nextjs-app-on-github-pages"/><meta name="description" content="
    Starting a blog on GitHub Pages sounded like a good idea. Doing it in SSG-ed
    Next.js even better. What could possibly go WTF?
"/><meta property="og:type" content="article"/><meta property="og:title" content="Next.js app on GitHub Pages"/><meta property="og:description" content="
    Starting a blog on GitHub Pages sounded like a good idea. Doing it in SSG-ed
    Next.js even better. What could possibly go WTF?
"/><meta property="og:site_name" content="Kajgod Blog"/><meta property="article:author" content="https://www.facebook.com/jurica.staresincic"/><meta property="article:section" content="Technology"/><meta property="article:published_time" content="2023-01-11 08:00:00 +0000 UTC"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:description" content="
    Starting a blog on GitHub Pages sounded like a good idea. Doing it in SSG-ed
    Next.js even better. What could possibly go WTF?
"/><meta name="twitter:title" content="Next.js app on GitHub Pages"/><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/27d6fa2c81197e1c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/27d6fa2c81197e1c.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-8fa1640cc84ba8fe.js" defer=""></script><script src="/_next/static/chunks/framework-3b5a00d5d7e8d93b.js" defer=""></script><script src="/_next/static/chunks/main-f2e125da23ccdc4a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-13c6f541b8685723.js" defer=""></script><script src="/_next/static/chunks/996-c5e5aa4c30f33066.js" defer=""></script><script src="/_next/static/chunks/512-1fac980f254d6c62.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-4e4179f8393c4644.js" defer=""></script><script src="/_next/static/ApQzjsrX52Fp1ViLIV44B/_buildManifest.js" defer=""></script><script src="/_next/static/ApQzjsrX52Fp1ViLIV44B/_ssgManifest.js" defer=""></script></head><body><div id="__next"><a href="/"><h1>Kajgod blog</h1></a><main class="main-single-article"><p class="small">2023<span class="highlight">01</span>11</p><h2>Next.js app on GitHub Pages</h2><div class="article-container"><p>I never tried GitHub Pages before, but I figured if I was going to write a blog about my experiences with technology and CS, it would have a<!-- --> <em>clean code</em> feel to it if I encapsulated the thoughts and ideas with related code.</p><p>Being an amateur artist in spare time, I decided I should have two completely separate blogs for documenting two completely separate domains, but again - the second blog should also encapsulate &quot;art&quot; with thoughts about art.</p><p>On a more-or-less unrelated note: I wanted to make both very easy to add to. I&#x27;m planning to make an offline CMS for it which would create the content and commit it to appropriate repo. To lessen the code-writing I have to do (albeit complicate the process a bit) I decided to parse JSONs created in the CMS with Next.js. Now, Next is something I know quite well. The thought of trying something more egzotic and hip like Qwik, Fresh or Astro certainly crossed my mind, but I wanted this thing live as soon as possible, so...</p><p>All of this led to the first WTF moment on GitHub Pages.</p><h3>WTF, GitHub?</h3><p>I followed the simplest flow to getting a GitHub Page: create a repo named<!-- --> <!-- -->[yourName].github.io and place static HTML in the root. To do so I could have changed a Next config, but I wanted to keep Next separated from the generated page in a separate folder, so I rather just added a copy action to build scrip like so:</p><pre>next build &amp;&amp; next export &amp;&amp; cp -r out/* ../</pre><p>Well, it didn&#x27;t work. At all.</p><p>Since I couldn&#x27;t figure out what seems to be the matter, I handcrafted a simple HTML page and put it in the root. That was fine, but when I tried to serve Next code again: nothing. Now, Next creates a folder _next where it serves JS and such. Nothing from that directory gets served on GitHub Pages! Hmmmm... Could it be that Pages only serves files that are in the root? You cannot use any folders? Starting to get irate, and looking into Vercel hosting and abandoning the whole <em>encapsulation</em> idea, Duck Duck Go once again came to the rescue!</p><p>Believe it or not, my dear friends, GitHub Pages considers any folder that starts with an underscore as a Jekyll folder and ignores it when serving content. WTF? I never really used Jekyll (we have some CI/CD workflow at my day job, but I never had to do much more than restart the computer running it) and it seems so random and odd to give it (and it&#x27;s conventions) the first-class-citizen treament. Just let it take over all other software that uses the _[folder - name] file structure?</p><h3>All&#x27;s well...</h3><p>On a positive note, the fix is quite simple:</p><pre>next build &amp;&amp; next export &amp;&amp; cp -r out/* ../ &amp;&amp; touch ../.nojekyll</pre><p>...create an empty .nojekyll file in the root, and the blog page appears. The only problem with this approach as far as I can tell is that the old files remain in the _next folder because they always get prefied. A delete before copying in the build script fixes it in most cases (close enough for all intents and purposes, anyway):</p><pre>rm -r ../_next &amp;&amp; next build &amp;&amp; next export &amp;&amp; cp -r out/* ../ &amp;&amp; touch ../.nojekyll</pre><p>Next is quite ubiquitous these days, so I guess I&#x27;m not the only one to run into this problem, and this short rant may actually prove useful to someone. You&#x27;re welcome, if that happens to be you.</p></div></main><footer><nav><ul><li><a href="/">Home</a></li><li><a href="/">About Me</a></li><li><a href="/articles-archive">Archive</a></li></ul></nav></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slug":"nextjs-app-on-github-pages"},"__N_SSG":true},"page":"/[slug]","query":{"slug":"nextjs-app-on-github-pages"},"buildId":"ApQzjsrX52Fp1ViLIV44B","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>